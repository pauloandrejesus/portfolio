TabDimCalendÃ¡rio = 
VAR vDataInicial =
    MIN (
        FIRSTDATE ( 'TabFatNotaFiscalCabeÃ§alho'[Data da Venda] ),
        FIRSTDATE ( TabFatMetaVendas[Data da Meta] )
    )
VAR vDataFinal =
    MAX (
        LASTDATE ( 'TabFatNotaFiscalCabeÃ§alho'[Data da Venda] ),
        LASTDATE ( TabFatMetaVendas[Data da Meta] )
    )
VAR vLocal = "pt-br"
VAR vPrimeiroDia = 2
VAR vCalendario =
    SELECTCOLUMNS ( CALENDAR ( vDataInicial, vDataFinal ), "Data ReferÃªncia", [Date] )
RETURN
    ADDCOLUMNS (
        vCalendario,
        "Data (AAAAMMDD)", FORMAT ( [Data ReferÃªncia], "YYYYMMDD" ),
        "Data (ddd dd/mm/aaaa)", FORMAT ( [Data ReferÃªncia], "DDD DD/MM/YYYY", vLocal ),
        "Ano", YEAR ( [Data ReferÃªncia] ),
        "Semestre #", IF ( MONTH ( [Data ReferÃªncia] ) <= 6, 1, 2 ),
        "Semestre",
            "S"
                & IF ( MONTH ( [Data ReferÃªncia] ) <= 6, 1, 2 ),
        "Trimestre #", QUARTER ( [Data ReferÃªncia] ),
        "Trimestre", "T" & FORMAT ( [Data ReferÃªncia], "Q" ),
        "Ano/Trimestre", FORMAT ( [Data ReferÃªncia], "YYYY/Q" ),
        "MÃªs #", MONTH ( [Data ReferÃªncia] ),
        "MÃªs", FORMAT ( [Data ReferÃªncia], "MMMM", vLocal ),
        "MÃªs (Abreviado)", FORMAT ( [Data ReferÃªncia], "mmm", vLocal ), 
        "EstaÃ§Ã£o #",
            SWITCH (
                TRUE (),
                MONTH ( [Data ReferÃªncia] ) IN { 12, 01, 02 }, 2,
                MONTH ( [Data ReferÃªncia] ) IN { 03, 04, 05 }, 3,
                MONTH ( [Data ReferÃªncia] ) IN { 06, 07, 08 }, 4,
                MONTH ( [Data ReferÃªncia] ) IN { 09, 10, 11 }, 1
            ),
        "EstaÃ§Ã£o",
            SWITCH (
                TRUE (),
                MONTH ( [Data ReferÃªncia] ) IN { 12, 01, 02 }, "â˜€ï¸ VerÃ£o",
                MONTH ( [Data ReferÃªncia] ) IN { 03, 04, 05 }, "ðŸ‚ Outono",
                MONTH ( [Data ReferÃªncia] ) IN { 06, 07, 08 }, "â„ï¸ Inverno",
                MONTH ( [Data ReferÃªncia] ) IN { 09, 10, 11 }, "ðŸŒ¼ Primavera"
            ),
        "EstaÃ§Ã£o Cor",
            SWITCH (
                TRUE (),
                MONTH ( [Data ReferÃªncia] ) IN { 12, 01, 02 }, "#FCD53F",
                MONTH ( [Data ReferÃªncia] ) IN { 03, 04, 05 }, "#E19747",
                MONTH ( [Data ReferÃªncia] ) IN { 06, 07, 08 }, "#00A6ED",
                MONTH ( [Data ReferÃªncia] ) IN { 09, 10, 11 }, "#86D72F"
            ),
        "Ano/MÃªs", FORMAT ( [Data ReferÃªncia], "YYYY/MM" ),
        "Ano/MÃªs (Abreviado)", FORMAT ( [Data ReferÃªncia], "YYYY/mmm", vLocal ),
        "Semana #", WEEKNUM ( [Data ReferÃªncia], vPrimeiroDia ),
        "Semana", WEEKNUM ( [Data ReferÃªncia], vPrimeiroDia ) & "Âª semana",
        "Quinzena #", IF ( DAY ( [Data ReferÃªncia] ) <= 15, 1, 2 ),
        "Quinzena",
            "Q"
                & IF ( DAY ( [Data ReferÃªncia] ) <= 15, 1, 2 ),
        "Dia da Semana #", WEEKDAY ( [Data ReferÃªncia], vPrimeiroDia ),
        "Dia da Semana", FORMAT ( [Data ReferÃªncia], "dddd", vLocal ),
        "Dia da Semana (Abreviado)", FORMAT ( [Data ReferÃªncia], "ddd", vLocal ),
        "Fim-de-Semana", FORMAT ( WEEKDAY ( [Data ReferÃªncia], 2 ) >= 6, "Yes/No", vLocal ),
        "Dia", DAY ( [Data ReferÃªncia] )
    )